/*! Search.js 2014-10-22 */
function Color(a,b,c){this.red=parseInt(a),this.green=parseInt(b),this.blue=parseInt(c),this.asCssRgb=function(){return"rgb({0},{1},{2})".format(a,b,c)},this.asDataRgb=function(){return"{0}|{1}|{2}".format(a,b,c)}}function overlay(a,b){var c,d=a/rgbMax,e=b/rgbMax;c=.5>d?2*d*e:1-2*(1-d)*(1-e);var f=255*c;return Math.floor(f)}function blendOverlay(a,b){var c=overlay(a.red,b.red),d=overlay(a.green,b.green),e=overlay(a.blue,b.blue);return new Color(c,d,e)}function random(a){return Math.floor(Math.random()*a)}function getRandomColor(){"use strict";var a,b,c;return a=Math.floor((random(256)+seed.red)/2),b=Math.floor((random(256)+seed.green)/2),c=Math.floor((random(256)+seed.blue)/2),new Color(a,b,c)}function getCoordinate(a,b){return $('.coordinate[data-x="{0}"][data-y="{1}"]'.format(a,b))}function showSolutions(a){"use strict";var b,c,d,e,f,g,h,i,j,k;for($("#puzzle-table").find("td > input").each(function(){$(this).prop("disabled",!0),$(this).addClass("done")}),b=0;b<a.length;b++)if(i=getRandomColor(),g=a[b],g.found)for(d=g.x,e=g.y,j=g.word.split(""),c=0;c<j.length;c++)f=getCoordinate(d,e),k=f.data("colors")?f.data("colors")+",":"",k+=i.asDataRgb(),f.addClass("used"),f.attr("data-colors",k),h=DIRECTION[g.dir],c!=j.length-1&&(d+=h.incrementX,e+=h.incrementY);$("input[data-colors]").each(function(){for(var a=$(this).attr("data-colors").split(","),b=void 0,c=0;c<a.length;c++){var d=a[c].split("|"),e=new Color(d[0],d[1],d[2]);b=void 0===b?e:blendOverlay(b,e)}$(this).css("background-color",b.asCssRgb())})}function Puzzle(a){this.lines=a,this.limitX=a[0].length-1,this.limitY=a.length-1,this.get=function(b,c){return a[c].charAt(b)},this.has=function(a,b){return a>=0&&a<=this.limitX&&b>=0&&b<=this.limitY},this.solve=function(a){for(var b=new Array(a.length),c=0;c<b.length;c++)for(var d=a[c],e=0;e<this.limitY;e++)for(var f=0;f<this.limitX;f++)for(var g in DIRECTION){for(var h=f,i=e,j=0,k="";this.has(h,i)&&k!=d&&this.get(h,i)==d.charAt(j);){var l=this.get(h,i);h+=DIRECTION[g].incrementX,i+=DIRECTION[g].incrementY,j++,k+=l}k==d&&(b[c]=new Solution(d),b[c].find(f,e,g))}for(var c=0;c<b.length;c++){var m=b[c];void 0===m&&(b[c]=new Solution(a[c]))}return b}}function Solution(a){this.word=a,this.found=!1,this.find=function(a,b,c){this.found=!0,this.dir=c,this.x=a,this.y=b}}function Direction(a,b){this.incrementX=a,this.incrementY=b}var testing={puzzle:["APDSPSXTLGKMOCLOHOCLAZLT","KLMXSOENZLNGASWSQJVFVEDE","INOSLWOBPOLNJAQPFCK1KFHP","NEICTNALIPAFTSSIGEEOILEQ","BGKRHZYTCLQEYVXRYBERDDFR","YAQWDOAECFRGQLNIGERQWLUW","BWIENBNLMOHQUBTTHICTUTBB","BEDIIQMEQUUTELNIGQFIAWHF","WSALRFOMYNFOHMTAEYDLCEOR","HRWSIAIOETDRCBTLVGTHOLWF","SCLZVISNHAEBEEHRGMILDWES","XHNVEHTAFIKAAPKMBNERVTYJ","DNOERFUDENATFCYBOCBVKXOI","LBEWRLREKHOHOXBGIVNAOTVM","AOCSEDETSKSTGZCUGOPJOCFB","KZOKERSXRESYEGJXYOZTRMCY"],words:"ALCOHOL,FLUID,LEMONADE,SEWAGE,BATH,FOUNTAIN,LIBATION,SHOWER,BROOK,GEYSER,MILD,SOAKED,BROTH,GLOP,MIST,SOGGY,CANAL,GULT,MOISTURE,SOUP,COLA,HONEY,PERFUME,SPIRIT,CREEK,INLET,POOL,STOCK,DRENCH,IRRIGATE,RAIN,SWEAT,DRINK,JUICE,RIVER,WATER,FLOW,LAKE,SEAS,WET".split(","),init:function(){return this.width=this.puzzle[0].length,this.height=this.puzzle.length,this},enabled:!0}.init(),rgbMax=255,seed=new Color(255,255,255);$(function(){"use strict";var a,b,c=$("#puzzle-table"),d=testing.width,e=testing.height,f="";for(a=0;e>a;a++){for(f+="<tr>",b=0;d>b;b++)f+="<td>"+'<input class="coordinate" maxlength="1" type="text" data-x="{0}" data-y="{1}" />'.format(b,a)+"</td>";f+="</tr>"}if(c.append(f),$(".coordinate").keypress(function(a){return a.keyCode>=65&&a.keyCode<=90||a.keyCode>=97&&a.keyCode<=122?($.emulateTab(),!0):!1}),$("#solve").click(function(a){var b,c,d,f=$(".coordinate"),g=new Array(e);f.each(function(b,e){a=$(e),c=a.data("x"),d=a.data("y"),void 0===g[d]&&(g[d]=""),g[d]+=$(e).val().toUpperCase()}),b=$("#words").val().replace(/ /g,",").toUpperCase().split(","),showSolutions(new Puzzle(g).solve(b))}),testing.enabled){for(var g=0;g<testing.height;g++)for(var h=testing.puzzle[g].split(""),i=0;i<testing.width;i++)getCoordinate(i,g).val(h[i]);$("#words").val(testing.words.join(" "))}}),String.prototype.format||(String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return"undefined"!=typeof a[c]?a[c]:b})});var DIRECTION={NORTH:new Direction(0,-1),NORTHEAST:new Direction(1,-1),EAST:new Direction(1,0),SOUTHEAST:new Direction(1,1),SOUTH:new Direction(0,1),SOUTHWEST:new Direction(-1,1),WEST:new Direction(-1,0),NORTHWEST:new Direction(-1,-1)};